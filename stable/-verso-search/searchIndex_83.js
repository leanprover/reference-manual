window.docContents[83].resolve({"/Definitions/Recursive-Definitions/#The-Lean-Language-Reference--Definitions--Recursive-Definitions--Controlling-Reduction--Reducibility-and-Tactics":{"contents":"The tactics with_reducible, with_reducible_and_instances, and with_unfolding_all control which definitions are unfolded by most tactics.\n\nReducibility and TacticsThe functions plus, sum, and tally are all synonyms for Nat.add that are respectively reducible, semireducible, and irreducible:abbrev plus := Nat.add\n\ndef sum := Nat.add\n\n@[irreducible]\ndef tally := Nat.add\nThe reducible synonym is unfolded by simp:theorem plus_eq_add : plus x y = x + y := by simp\nThe semireducible synonym is not, however, unfolded by simp:theorem sum_eq_add : sum x y = x + y := by simp\nNonetheless, the definitional equality check induced by rfl unfolds the sum:theorem sum_eq_add : sum x y = x + y := by rfl\nThe irreducible tally, however, is not reduced by definitional equality.theorem tally_eq_add : tally x y = x + y := by rfl\nThe simp tactic can unfold any definition, even irreducible ones, when they are explicitly provided:theorem tally_eq_add : tally x y = x + y := by simp [tally]\nSimilarly, part of a proof can be instructed to ignore irreducibility by placing it in a with_unfolding_all block:theorem tally_eq_add : tally x y = x + y := by with_unfolding_all rfl\n\n\n","context":"Lean Reference\u0009Definitions\u0009Recursive Definitions\u0009Controlling Reduction","header":"7.6.6.1. Reducibility and Tactics","id":"/Definitions/Recursive-Definitions/#The-Lean-Language-Reference--Definitions--Recursive-Definitions--Controlling-Reduction--Reducibility-and-Tactics"},"/releases/v4.19.0/#The-Lean-Language-Reference--Release-Notes--Lean-4___19___0-_LPAR_2025-05-01_RPAR_--Language":{"contents":"* #5182 makes functions defined by well-founded recursion use an\nopaque well-founded proof by default; see highlights section for details.* #5998 lets omega always abstract its own proofs into an auxiliary\ndefinition. The size of the olean of Vector.Extract goes down from 20MB\nto 5MB with this, overall stdlib olean size and build instruction count\ngo down 5%.* #6325 ensures that environments can be loaded, repeatedly, without\nexecuting arbitrary code* #7075 ensures that names suggested by tactics like simp? are not\nshadowed by auxiliary declarations in the local context and that names\nof let rec and where declarations are correctly resolved in tactic\nblocks.* #7166 extends the notion of “fixed parameter” of a recursive function\nalso to parameters that come after varying function; see highlights section for details.* #7256 introduces the assert! variant debug_assert! that is\nactivated when compiled with buildType debug.* #7304 fixes an issue where nested let rec declarations within\nmatch expressions or tactic blocks failed to compile if they were\nnested within, and recursively called, a let rec that referenced a\nvariable bound by a containing declaration.* #7324 changes the internal construction of well-founded recursion, to\nnot change the type of fix’s induction hypothesis in non-defeq ways.* #7333 allows aux decls (like generated by match) to be generated by\ndecreasing_by tactics.* #7335 modifies elabTerminationByHints in a way that the type of the\nrecursive function used for elaboration of the termination measure is\nstriped of from optional parameters. It prevents introducing\ndependencies between the default values for arguments, that can cause\nthe termination checker to fail.* #7353 changes abstractNestedProofs so that it also visits the\nsubterms in the head of an application.* #7362 allows simp dischargers to add aux decls to the environment.\nThis enables tactics like native_decide to be used here, and unblocks\nimprovements to omega in #5998.* #7387 uses -implicitDefEqProofs in bv_omega to ensure it is not\naffected by the change in #7386.* #7397 ensures that Poly.mul p 0 always returns Poly.num 0.* #7409 allows the use of dsimp during preprocessing of well-founded\ndefinitions. This fixes regressions when using if-then-else without\ngiving a name to the condition, but where the condition is needed for\nthe termination proof, in cases where that subexpression is reachable\nonly by dsimp, but not by simp (e.g. inside a dependent let)* #7431 changes the syntax of location modifiers for tactics like simp\nand rw (e.g., simp at h ⊢) to allow the turnstile ⊢ to appear\nanywhere in the sequence of locations.* #7509 disables the implicitDefEqProofs simp option in the\npreprocessor of bv_decide in order to account for regressions caused\nby #7387.* #7511 fixes two bugs in simp +arith that were preventing specific\nsubterms from being normalized.* #7515 fixes another bug in simp +arith. This bug was affecting\ngrind. See new test for an example.* #7551 changes isNatCmp to ignore optional arguments annotations,\nwhen checking for <-like comparison between elements of Nat. That\npreviously caused guessLex to fail when checking termination of a\nfunction, whose signature involved an optional argument of the type\nNat.* #7560 ensures that we use the same ordering to normalize linear Int\nterms and relations. This change affects simp +arith and grind\nnormalizer.* #7622 fixes fun_induction when used on structurally recursive\nfunctions where there are targets occurring before fixed parameters.* #7630 fixes a performance issue in the whnfCore procedure.* #7728 fixes an issue in abstractNestedProofs.\nWe should abstract proofs occurring in the inferred proposition too.\n\n\n\n\n\n\n\n\n\n\n\n","context":"Lean Reference\u0009Release Notes\u0009Lean 4.19.0 (2025-05-01)","header":"Language","id":"/releases/v4.19.0/#The-Lean-Language-Reference--Release-Notes--Lean-4___19___0-_LPAR_2025-05-01_RPAR_--Language"},"/releases/v4.27.0/#The-Lean-Language-Reference--Release-Notes--Lean-4___27___0-_LPAR_2026-01-24_RPAR_--Highlights--Backward-Compatibility-Options":{"contents":"#11304 documents that backward.* options are only temporary\nmigration aids and may disappear without further notice after 6 months\nafter their introduction. Users are kindly asked to report if they rely\non these options.\n\n","context":"Lean Reference\u0009Release Notes\u0009Lean 4.27.0 (2026-01-24)\u0009Highlights","header":"Backward Compatibility Options","id":"/releases/v4.27.0/#The-Lean-Language-Reference--Release-Notes--Lean-4___27___0-_LPAR_2026-01-24_RPAR_--Highlights--Backward-Compatibility-Options"},"/releases/v4.27.0/#The-Lean-Language-Reference--Release-Notes--Lean-4___27___0-_LPAR_2026-01-24_RPAR_--Language":{"contents":"* #7965 lets recursive functions defined by well-founded recursion use a\ndifferent fix function when the termination measure is of type Nat.\nThis fix-point operator use structural recursion on “fuel”, initialized\nby the given measure, and is thus reasonable to reduce, e.g. in by decide proofs.* #11196 avoids match splitter calculation from testing all quadratically\nmany pairs of alternatives for overlaps, by keeping track of possible\noverlaps during matcher calculation, storing that information in the\nMatcherInfo, and using that during matcher calculation.* #11200 changes how sparse case expressions represent the\nnone-of-the-above information. Instead of many x.ctorIdx ≠ i\nhypotheses, it introduces a single Nat.hasNotBit mask x.ctorIdx\nhypothesis which compresses that information into a bitmask. This avoids\na quadratic overhead during splitter generation, where all n assumptions\nwould be refined through .subst and .cases constructions for all n\nassumption of the splitter alternative.* #11221 lets realizeConst use withDeclNameForAuxNaming so that\nauxiliary definitions created there get non-clashing names.* #11222 implements elabToSyntax for creating scoped syntax s : Syntax for an arbitrary elaborator el : Option Expr -> TermElabM Expr\nsuch that elabTerm s = el.* #11236 extracts two modules from Match.MatchEqs, in preparation of\n#11220\nand to use the module system to draw clear boundaries between concerns\nhere.* #11239 adds a Unit assumption to alternatives of the splitter that\nwould otherwise not have arguments. This fixes #11211.* #11245 improves the error message encountered in the case of a type\nclass instance resolution failure, and adds an error explanation that\ndiscusses the common new-user case of binary operation overloading and\npoints to the trace.Meta.synthInstance option for advanced debugging.* #11256 replaces MatcherInfo.numAltParams with a more detailed data\nstructure that allows us, in particular, to distinguish between an\nalternative for a constructor with a Unit field and the alternative\nfor a nullary constructor, where an artificial Unit argument is\nintroduced.* #11261 continues the homogenization between matchers and splitters,\nfollowing up on #11256. In particular it removes the ambiguity whether\nnumParams includes the discrEqns or not.* #11269 adds support for decidable equality of empty lists and empty\narrays. Decidable equality for lists and arrays is suitably modified so\nthat all diamonds are definitionally equal.* #11292 adds intersection operation on\nExtDTreeMap/ExtTreeMap/ExtTreeSet and proves several lemmas about\nit.* #11301 allows setting reducibilityCoreExt in async contexts (e.g. when\nusing mkSparseCasesOn in a realizable definition)* #11302 renames the CTests tests to use filenames as test names. So\ninstead of        2080 - leanruntest_issue5767.lean (Failed)\nwe get        2080 - tests/lean/run/issue5767.lean (Failed)\nwhich allows Ctrl-Click’ing on them in the VSCode terminal.* #11303 renames rename wrongly named backwards. options to\nbackward.* #11304 documents that backward.* options are only temporary\nmigration aids and may disappear without further notice after 6 months\nafter their introduction. Users are kindly asked to report if they rely\non these options.* #11305 removes the group field from option descriptions. It is\nunused, does not have a clear meaning and often matches the first\ncomponent of the option name.* #11307 removes all code that sets the Option.Decl.group field, which\nis unused and has no clearly documented meaning.* #11325 adds CoreM.toIO', the analogue of CoreM.toIO dropping the\nstate from the return type, and similarly for TermElabM.toIO' and\nMetaM.toIO'.* #11333 adds infrastructure for parallel execution across Lean's tactic\nmonads.* #11338 upstreams the with_weak_namespace command from Mathlib:\nwith_weak_namespace <id> <cmd> changes the current namespace to <id>\nfor the duration of executing command <cmd>, without causing scoped\nthings to go out of scope. This is in preparation for upstreaming the\nscoped[Foo.Bar] syntax from Mathlib, which will be useful now that we\nare adding grind annotations in scopes.* #11346 modifies the error message for type synthesis failure for the\ncase where the type class in question is potentially derivable using a\nderiving command. Also changes the error explanation for type class\ninstance synthesis failure with an illustration of this pattern.* #11347 adds a focused error explanation aimed at the case where someone\ntries to use Natural-Numbers-Game-style induction proofs directly in\nLean, where such proofs are not syntactically valid.* #11353 applies beta reduction to specialization keys, allowing us to\nreuse specializations in more situations.* #11379 sets @[macro_inline] on the (trivial) .ctorIdx for inductive\ntypes with one constructor, to reduce the number of symbols generated by\nthe compiler.* #11385 lets implicit instance names avoid name clashes with private\ndeclarations. This fixes #10329.* #11408 adds a difference operation on\nExtDTreeMap/ExtTreeMap/TreeSet and proves several lemmas about it.* #11422 uses a kernel-reduction optimized variant of Mon.mul in grind.* #11425 changes Lean.Order.CCPO and .CompleteLattice to carry a\nProp. This avoids the CCPO IO instance from being noncomputable.* #11432 fixes a typo in the docstring of #guard_mgs.* #11453 fixes undefined behavior where delete (instead of delete[])\nis called on an object allocated with new[].* #11456 refines several error messages, mostly involving invalid\nuse of field notation, generalized field notation, and numeric\nprojection. Provides a new error explanation for field notation.* #11463 fixes a panic in getEqnsFor? when called on matchers generated\nfrom match expressions in theorem types.* #11474 generalizes the noConfusion constructions to heterogeneous\nequalities (assuming propositional equalities between the indices). This\nlays ground work for better support for applying injection to\nheterogeneous equalities in grind.* #11476 adds a {givenInstance}`C` documentation role that adds an\ninstance of C to the document's local assumptions.* #11482 gives suggestions based on the currently-available constants\nwhen projecting from an unknown type.* #11485 ensures that Nats in .olean files use a deterministic\nserialization in the case where LEAN_USE_GMP is not set.* #11490 prevents try swallowing heartbeat errors from nested simp\ncalls, and more generally ensures the isRuntime flag is propagated by\nthrowNestedTacticEx. This prevents the behavior of proofs (especially\nthose using aesop) being affected by the current recursion depth or\nheartbeat limit.* #11492 uses the helper functions withImplicitBinderInfos and\nmkArrowN in more places.* #11493 makes Match.MatchEqs a leaf module, to be less restricted in\nwhich features we can use there.* #11502 adds two benchmarks for elaborating match statements of many\nNat literals, one without and one with splitter generation.* #11508 avoids generating hyps when not needed (i.e. if there is a\ncatch-all so no completeness checking needed) during matching on values.This tweak was made possible by #11220.* #11510 avoids running substCore twice in caseValues.* #11511 implements a linter that warns when a deprecated coercion is\napplied. It also warns when the Option coercion or the\nSubarray-to-Array coercion is used in Init or Std. The linter is\ncurrently limited to Coe instances; CoeFun instances etc. are not\nconsidered.* #11518 provides an additional hint when the type of an autobound\nimplicit is required to have function type or equality type — this\nfails, and the existing error message does not address the fact that the\nsource of the error is an unknown identifier that was automatically\nbound.* #11541 adds support for underscores as digit separators in\nString.toNat?, String.toInt?, and related parsing functions. This makes\nthe string parsing functions consistent with Lean's numeric literal\nsyntax, which already supports underscores for readability (e.g.,\n100_000_000).* #11554 adds @[suggest_for] annotations to Lean, allowing lean to\nprovide corrections for .every or .some methods in place of .all\nor .any methods for most default-imported types (arrays, lists,\nstrings, substrings, and subarrays, and vectors).* #11555 scans the environment for viable replacements for a dotted\nidentifier (like .zero) and suggests concrete alternatives as\nreplacements.* #11562 makes the noConfusion principles even more heterogeneous, by\nallowing not just indices but also parameters to differ.* #11566 lets the compiler treat per-constructor noConfusion like the\ngeneral one, and moves some more logic closer to no confusion\ngeneration.* #11571 lets whnf not consult isNoConfusion, to speed up this hot\npath a bit.* #11587 adjusts the new meta keyword of the experimental module system\nnot to imply partial for general consistency.* #11607 makes argument-less tactic invocations of Std.Do tactics such\nas mintro emit a proper error message \"mintro expects at least one\npattern\" instead of claiming that Std.Tactic.Do needs to be imported.* #11611 fixes a noConfusion compilation introduced by #11562.* #11619 allows Lean to present suggestions based on @[suggest_for]\nannotations for unknown identifiers without internal dots. (The\nannotations in #11554 only gave suggestion for dotted identifiers like\nArray.every->Array.all and not for bare identifiers like\nResult->Except or ℕ->Nat.)* #11620 ports Batteries.WF to Init.WFC for executable well-founded\nfixpoints. It introduces csimp theorems to replace the recursors and\nnon-executable definitions with executable definitions.* #11621 causes Lean to search through @[suggest_for] annotations on\ncertain errors that look like unknown identifiers that got incorrectly\nautobound. This will correctly identify that a declaration of type\nMaybe String should be Option String instead.* #11624 fixes a SIGFPE crash on x86_64 when evaluating INT_MIN / -1 or\nINT_MIN % -1 for signed integer types.* #11637 declares the module system as no longer experimental and makes\nthe experimental.module option a no-op, to be removed.* #11644 makes .ctorIdx not an abbrev; we don't want grind to unfold\nit.* #11645 fixes the docstring of propagateForallPropUp. It was\ncopy’n’pasta before.* #11652 teaches grind how to reduce .ctorIdx applied to\nconstructors. It can also handle tasks likexs ≍ Vec.cons x xs' → xs.ctorIdx = 1\nthanks to a .ctorIdx.hinj theorem (generated on demand).* #11657 improves upon #11652 by keeping the kernel-reduction-optimized\ndefinition.\n\n","context":"Lean Reference\u0009Release Notes\u0009Lean 4.27.0 (2026-01-24)","header":"Language","id":"/releases/v4.27.0/#The-Lean-Language-Reference--Release-Notes--Lean-4___27___0-_LPAR_2026-01-24_RPAR_--Language"}});